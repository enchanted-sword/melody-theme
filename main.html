<script>
								post = document.getElementById("{PostID}");
								npf = {NPF};
								console.log(npf);
								function blogObject(blog, avatar, id) {
									let blogCard = document.createElement("div");
									blogCard.classList.add("blog-card");
									blogCard.id = id;
									blogCard.style.backgroundColor = blog.theme.background_color;
									let blogHeader = document.createElement("img");
									blogHeader.classList.add("blog-header");
									blogHeader.src = blog.theme.header_image;
									blogHeader.width = 256;
									blogHeader.height = Math.floor(blog.theme.header_full_height / (blog.theme.header_full_width / 256));
									blogCard.appendChild(blogHeader);
									let blogAvatar = document.createElement("img");
									blogAvatar.classList.add("blog-avatar");
									if (blog.theme.avatar_shape === "circle") {blogAvatar.style.borderRadius = "50%";}
									blogAvatar.src = avatar;
									blogAvatar.style.top = blogHeader.height - 60 + "px";
									blogCard.appendChild(blogAvatar);
									let blogDescription = document.createElement("div");
									blogDescription.classList.add("blog-description");
									blogDescription.style.top = blogHeader.height + "px";
									blogDescription.style.color = blog.theme.title_color;
									let a = document.createElement("b");
									a.style.color = blog.theme.link_color;
									a.style.textDecoration = "none";
									a.style.fontSize = "24px";
									a.innerText = blog.name;
									blogDescription.appendChild(a);
									blogDescription.innerHTML += "<br>"
									let b = document.createElement("p");
									b.style.fontSize = "20px";
									b.style.margin = "8px 0px 8px 0px";
									b.style.fontWeight = "bold";
									b.style.hyphens = "auto";
									b.innerText = blog.title;
									blogDescription.appendChild(b);
									let p = document.createElement("p");
									p.innerHTML = blog.description;
									p.style.margin = "8px 0px 8px 0px";
									blogDescription.appendChild(p);
									blogCard.appendChild(blogDescription);
									blogCard.addEventListener("click", (event) => {
										window.open(blog.url);
									})
									blogCard.addEventListener("mouseleave", (event) => {
										document.getElementById(id).style.opacity = "0";
										document.getElementById(id).style.visibility = "hidden";
									});
									return blogCard;
								}
								function formatEncode(content) {
									let obj = [];
									let string = ""
									for (let x of content.text) {
										obj.push(x);
									}
									for (n = 0; n < content.formatting.length; ++n) {
										let start = 0;
										let end = 0;
										let formatting = content.formatting[n];
										let c = numeral(n).format('0000') + numeral;
										let format = { 
											bold: "b", 
											italic: "i", 
											strikethrough: "s", 
											small: "small" 
										}[formatting.type] || "a"
										let startTag = "<" + format + ">";
										let endTag = "</" + format + ">";
										if (formatting.type === "link") {
											startTag = "<a href=\"" + formatting.url + "\">";
										}
										else if (formatting.type === "mention") {
											startTag = "<a class=\"mention\" href=\"" + formatting.blog.url + "\">"
										}
										if (n === 0) {
											start = formatting.start
										}
										else {
											let r = 0;
											for (i = 0; i < content.formatting.length; ++i) {
												if (content.formatting[i].start < formatting.start) {
													++r;
												}
												if (content.formatting[i].end < formatting.start) {
													++r
												}
											}
											start = formatting.start + r;
										}
										let q = 0;
										for (i = 0; i < content.formatting.length; ++i) {
											if (content.formatting[i].start < formatting.end) {
												++q
											}
											if (content.formatting[i].end < formatting.end) {
												++q
											}
										}
										end = formatting.end + q;
										obj.splice(start, 0, startTag);
										obj.splice(end, 0, endTag)
									}
									for (let k = 0; k < obj.length; ++k) {
										string += obj[k];
									}
									return string;
								}
								if (npf.trail.length > 0) {
									for (let z = 0; z < npf.trail.length; ++z) {
										body = document.createElement("div");
										post.appendChild(body);
										body.classList.add("post-body");
										if (npf.trail[z].layout[0] && npf.trail[z].layout[0].type === "ask") {
											ask = document.createElement("div");
											ask.classList.add("ask");
											askHeader = document.createElement("div");
											ask.appendChild(askHeader);
											askHeader.classList.add("post-header");
											askHeader.classList.add("asker");
											portrait = document.createElement("img");
											askHeader.appendChild(portrait);
											portrait.classList.add("portrait");
											c = document.createElement("span");
											askHeader.appendChild(c);
											c.classList.add("post-avatar");
											c.classList.add("style-text");
											c.classList.add("tr");
											c.style.marginLeft = "8px";
											b = document.createElement("b");
											if (npf.trail[z].layout[0].attribution.blog) {
												c.classList.add("blog");
												let blog = npf.trail[z].layout[0].attribution.blog;
												let id = "askerBlog" + "{PostID}";
												let avatar = "{block:Answer}{AskerPortraitUrl-96}{/block:Answer}";
												c.appendChild(blogObject(blog, avatar, id));
												c.addEventListener("mouseenter", (event) => {
													document.getElementById(id).style.visibility = "visible";
													document.getElementById(id).style.opacity = "1";
												});
											}
											c.appendChild(b);
											{block:Answer}
												portrait.src = "{AskerPortraitUrl-64}";
												b.innerHTML = `{lang:Asker asked 2}`;
											{/block:Answer}
											card = document.createElement("div");
											body.appendChild(card);
											card.classList.add("post-card");
											card.id = "ct" + z + "{PostID}";
											card.appendChild(ask);
											header = document.createElement("div");
											card.appendChild(header);
											header.classList.add("post-header");
											header.classList.add("answerer")
											portrait = document.createElement("img");
											header.appendChild(portrait);
											portrait.classList.add("portrait");
											d = document.createElement("span");
											header.appendChild(d);
											d.classList.add("post-avatar");
											d.classList.add("style-text");
											e = document.createElement("b");
											if (npf.trail[z].blog) {
												d.classList.add("blog");
												let blog = npf.trail[z].blog;
												let id = "answererBlog" + "{PostID}";
												let avatar = "{block:Answer}{AnswererPortraitUrl-96}{/block:Answer}";
												d.appendChild(blogObject(blog, avatar, id));
												d.addEventListener("mouseenter", (event) => {
													document.getElementById(id).style.visibility = "visible";
													document.getElementById(id).style.opacity = "1";
												});
											}
											d.appendChild(e);
											{block:Answer}
												portrait.src = "{AnswererPortraitURL-64}";
												e.classList.add("reblog-root");
												e.innerHTML = `{Answerer}`;
											{/block:Answer}
										}
										else {
											header = document.createElement("div");
											body.appendChild(header);
											header.classList.add("post-header");
											s = document.createElement("span");
											header.appendChild(s);
											if (npf.trail[z].blog) {
												if (npf.trail[z].blog.active) {
													a = document.createElement("a");
													a.classList.add("style-text");
													a.classList.add("header-link");
													s.appendChild(a);
													portrait = document.createElement("img");
													portrait.classList.add("portrait");
													portraitUrl = "https://api.tumblr.com/v2/blog/" + npf.trail[z].blog.name + "/avatar/96";
													portrait.src = portraitUrl;
													a.appendChild(portrait);
													b = document.createElement("b");
													b.classList.add("reblog-root");
													a.appendChild(b);
													a.href = npf.trail[z].blog.url + "/post/{PostID}";
													b.innerText = npf.trail[z].blog.name;
													s.classList.add("blog");
													let blog = npf.trail[z].blog;
													let id = "blog" + z + "{PostID}";
													let avatar = portraitUrl;
													s.appendChild(blogObject(blog, avatar, id));
													s.addEventListener("mouseenter", (event) => {
														document.getElementById(id).style.visibility = "visible";
														document.getElementById(id).style.opacity = "1";
													});
												}
												else {
													b = document.createElement("b");
													b.classList.add("reblog-root");
													b.innerText = npf.trail[z].blog.name;
													b.innerHTML += "<span style=\"color: #a0a0a0; font-size: 12px; margin-left: 8px; line-height: 12px;\">deactivated</span>";
													s.appendChild(b);
												}
											}
											else if (npf.trail[z].broken_blog_name) {
												a.appendChild(b);
												b.innerText = npf.trail[z].broken_blog_name;
											}
											card = document.createElement("div");
											body.appendChild(card);
											card.classList.add("post-card");
											card.id = "ct" + z + "{PostID}";
										}
										for (let i = 0; i < npf.trail[z].content.length; ++i) {
											if (npf.trail[z].layout[0] && npf.trail[z].layout[0].type === "ask" && npf.trail[z].layout[0].blocks[i] === i) {
												card = ask;
											}
											else {
												card = document.getElementById("ct" + z + "{PostID}");
											}
											content = npf.trail[z].content[i];
											type = content.type;
											if (type === "text") {
												subtype = content.subtype;
												p = document.createElement("div");
												p.classList.add("text-wrapper");
												card.appendChild(p);
												if (content.formatting) {
													p.innerHTML = formatEncode(content);
												}
												else {p.innerHTML = content.text;}
												if (subtype) {p.classList.add(subtype);}
												if (subtype === "heading1") {p.style.fontSize = "28px";}
												else if (subtype === "heading2") {p.style.fontSize = "20px";}
												else if (subtype === "quote") {p.classList.add("serif-text");}
												else if (subtype === "chat") {p.classList.add("style-text");}
												else if (subtype === "indented") {
													p.style.marginLeft = "20px"
													p.classList.add("indented");
												}
												else if (subtype === "unordered-list-item") {
													p.innerHTML = "• " + p.innerHTML;
													p.style.marginLeft = "20px"
												}
												if (content.indent_level) {
													p.style.marginLeft = "\"" + (20 * content.indent_level) + "px\""
												}
											}
											else if (type === "image") {
												div = document.createElement("div")
												card.appendChild(div);
												img = document.createElement("img");
												div.appendChild(img);
												div.style.position = "relative"
												img.classList.add("image");
												media = content.media[0];
												img.src = media.url;
												img.width = 516;
												r = media.width / 516;
												img.height = media.height / r;
												if (content.alt_text) {
													img.alt = content.alt_text;
													alt = document.createElement("span");
													div.appendChild(alt);
													alt.innerHTML = "<b>ALT</b>";
													alt.classList.add("alt");
													alt.id = "alt" + i + "{PostID}";
													alt.style.top = (img.height - 32) + "px";
													let id = "alt" + i + "{PostID}";
													let altText = img.alt;
													alt.addEventListener("click", (event) => {
														if (event.target.innerText === "ALT") {event.target.innerText = "Image Description: " + altText;}
														else {event.target.innerHTML = "<b>ALT</b>";}
													});
												}
											}
											else if (type === "link") {
												link = document.createElement("a");
												card.appendChild(link);
												link.classList.add("link");
												link.href = content.url;
												if (content.poster) {
													wrapper = document.createElement("div")
													link.appendChild(wrapper);
													wrapper.classList.add("wrapper");
													wrapper.style.backgroundImage = "url(" + content.poster[0].url + ")";
													span = document.createElement("span");
													wrapper.appendChild(span);
													span.classList.add("poster");
													span.innerHTML = "<h2 style=\"margin: 8px 0px 8px 0px;\"><b>" + content.title + "</h2></b>";
													if (content.description) {
														span.innerHTML += "<span>" + content.description + "</span><br>"
													}
													if (content.site_name) {
														span.innerHTML += "<span class=\"attr\">" + content.site_name + "</span>"
													}
												}
												else if (content.title) {
													div = document.createElement("div");
													link.appendChild(div);
													div.classList.add("link");
													div.innerHTML = "<h2 style=\"margin: 8px 0px 8px 0px;\"><b>" + content.title + "</h2></b>";
													if (content.description) {
														div.innerHTML += "<span>" + content.description + "</span><br>"
													}
													if (content.site_name) {
														div.innerHTML += "<span class=\"attr\">" + content.site_name + "</span>"
													}
												}
											}
											else if (type === "audio") {
												div = document.createElement("div");
												card.appendChild(div);
												if (content.embed_html) {
													div.innerHTML = content.embed_html;
												}
												else {
													info = document.createElement("div");
													info.style.padding = "4px";
													div.appendChild(info);
													audio = document.createElement("audio");
													div.appendChild(audio);
													div.classList.add("audio-wrapper");
													audio.classList.add("audio-player");
													audio.setAttribute("controls", "");
													audio.innerText = "Sorry! Your browser does not support the HTML audio player :/"
													source = document.createElement("source");
													audio.appendChild(source);
													if (content.url) {
														source.src = content.url;
													}
													if (content.poster) {
														poster = document.createElement("img");
														info.appendChild(poster);
														poster.classList.add("poster");
														poster.src = content.poster[0].url;
													}
													if (content.title) {
														info.innerHTML += "<h2 style=\"padding-top:8px;\" class=\"track-title\"><b>" + content.title + "</h2></b>";
													}
													else {
														info.innerHTML += "<h2 class=\"track-title\"><b>No Title Provided</h2></b>";
													}
													if (content.artist) {
														info.innerHTML += "<p class=\"track-title\">" + content.artist + "</p>"
													}
													else {
														info.innerHTML += "<p class=\"track-title\">No Artist Provided</p>"
													}
													if (content.album) {
														info.innerHTML += "<p class=\"track-title\">" + content.album + "</p>"
													}
													else {
														info.innerHTML += "<p class=\"track-title\">No Album Provided</p>"
													}
												}
											}
											else if (type === "video") {
												div = document.createElement("div");
												card.appendChild(div);
												if (content.embed_iframe) {
													videoFrame = document.createElement("iframe");
													videoFrame.style.border = "none";
													videoFrame.style.borderRadius = "8px";
													div.appendChild(videoFrame);
													videoFrame.width = 516;
													videoFrame.height = (516 / content.embed_iframe.width) * content.embed_iframe.height;
													videoFrame.src = content.embed_iframe.url;
												}
												else {
													video = document.createElement("video");
													div.appendChild(video);
													div.classList.add("video-wrapper");
													video.classList.add("video-player");
													video.width = 516;
													video.setAttribute("controls", "");
													video.innerText = "Sorry! Your browser does not support the HTML video player :/"
													source = document.createElement("source");
													video.appendChild(source);
													if (content.url) {
														source.src = content.url;
													}
												}
											}
											if (content.attribution) {
												data = content.attribution;
												attr = document.createElement("a");
												card.appendChild(attr);
												attr.classList.add("attr");
												if (data.type === "app") {
													attr.innerText = "Source: " + data.app_name;
												}
												else {
													attr.innerText = "Source: " + data.url.split("/")[2];
												}
												attr.href = data.url;
											}
										}
									}
								}
								if (npf.content.length > 0) {
									body = document.createElement("div");
									post.appendChild(body);
									body.classList.add("post-body");
									if (npf.trail.length > 0) {
										header = document.createElement("div");
										body.appendChild(header);
										header.classList.add("post-header");
										a = document.createElement("a");
										header.appendChild(a);
										a.classList.add("style-text");
										a.classList.add("header-link");
										b = document.createElement("b");
										portrait = document.createElement("img");
										a.appendChild(portrait);
										portrait.classList.add("portrait");
										a.appendChild(b);
										{block:Reblogs}
											portrait.src = "{PortraitURL-64}";
											a.href = "{Permalink}";
											b.classList.add("reblog-root");
											b.innerText = "{Username}";
										{/block:Reblogs}
									}
									if (npf.layout[0] && npf.layout[0].type === "ask") {
										ask = document.createElement("div");
										ask.classList.add("ask");
										askHeader = document.createElement("div");
										ask.appendChild(askHeader);
										askHeader.classList.add("post-header");
										askHeader.classList.add("asker");
										portrait = document.createElement("img");
										askHeader.appendChild(portrait);
										portrait.classList.add("portrait");
										c = document.createElement("span");
										askHeader.appendChild(c);
										c.classList.add("post-avatar");
										c.classList.add("style-text");
										c.classList.add("tr");
										c.style.marginLeft = "8px";
										b = document.createElement("b");
										if (npf.layout[0].attribution.blog) {
												c.classList.add("blog");
												let blog = npf.layout[0].attribution.blog;
												let id = "askerBlog" + "{PostID}";
												let avatar = "{block:Answer}{AskerPortraitUrl-96}{/block:Answer}";
												c.appendChild(blogObject(blog, avatar, id));
												c.addEventListener("mouseenter", (event) => {
													document.getElementById(id).style.visibility = "visible";
													document.getElementById(id).style.opacity = "1";
												});
											}
										c.appendChild(b);
										{block:Answer}
											portrait.src = "{AskerPortraitUrl-64}";
											b.innerHTML = `{lang:Asker asked 2}`;
										{/block:Answer}
									}
									card = document.createElement("div");
									body.appendChild(card);
									card.classList.add("post-card");
									card.id = "cc{PostID}";
									if (npf.layout[0] && npf.layout[0].type === "ask") {
										card.appendChild(ask);
									}
									for (let i = 0; i < npf.content.length; ++i) {
										if (npf.layout[0] && npf.layout[0].type === "ask" && npf.layout[0].blocks[i] === i) {
											card = ask;
										}
										else {
											card = document.getElementById("cc{PostID}");
										}
										let content = npf.content[i];
										type = content.type;
										if (type === "text") {
												subtype = content.subtype;
												p = document.createElement("div");
												p.classList.add("text-wrapper");
												card.appendChild(p);
												if (content.formatting) {
													p.innerHTML = formatEncode(content);
												}
												else {p.innerHTML = content.text;}
												if (subtype) {p.classList.add(subtype);}
												if (subtype === "heading1") {p.style.fontSize = "28px";}
												else if (subtype === "heading2") {p.style.fontSize = "20px";}
												else if (subtype === "quote") {p.classList.add("serif-text");}
												else if (subtype === "chat") {p.classList.add("style-text");}
												else if (subtype === "indented") {
													p.style.marginLeft = "20px"
													p.classList.add("indented");
												}
												else if (subtype === "unordered-list-item") {
													p.innerHTML = "• " + p.innerHTML;
													p.style.marginLeft = "20px"
												}
												if (content.indent_level) {
													p.style.marginLeft = "\"" + (20 * content.indent_level) + "px\""
												}
											}
										else if (type === "image") {
											div = document.createElement("div")
											card.appendChild(div);
											img = document.createElement("img");
											div.appendChild(img);
											div.style.position = "relative"
											img.classList.add("image");
											media = content.media[0];
											img.src = media.url;
											img.width = 516;
											r = media.width / 516;
											img.height = media.height / r;
											if (content.alt_text) {
												img.alt = content.alt_text;
												alt = document.createElement("span");
												div.appendChild(alt);
												alt.innerHTML = "<b>ALT</b>";
												alt.classList.add("alt");
												alt.id = "alt" + i + "{PostID}";
												alt.style.top = (img.height - 32) + "px";
												let id = "alt" + i + "{PostID}";
												let altText = img.alt;
												alt.addEventListener("click", (event) => {
													if (event.target.innerText === "ALT") {event.target.innerText = "Image Description: " + altText;}
													else {event.target.innerHTML = "<b>ALT</b>";}
												});
											}
										}
										else if (type === "link") {
											link = document.createElement("a");
											card.appendChild(link);
											link.classList.add("link");
											link.href = content.url;
											if (content.poster) {
												wrapper = document.createElement("div")
												link.appendChild(wrapper);
												wrapper.classList.add("wrapper");
												wrapper.style.backgroundImage = "url(" + content.poster[0].url + ")";
												span = document.createElement("span");
												wrapper.appendChild(span);
												span.classList.add("poster");
												span.innerHTML = "<h2 style=\"margin: 8px 0px 8px 0px;\"><b>" + content.title + "</h2></b>";
												if (content.description) {
													span.innerHTML += "<span>" + content.description + "</span><br>"
												}
												if (content.site_name) {
													span.innerHTML += "<span class=\"attr\">" + content.site_name + "</span>"
												}
											}
											else if (content.title) {
												div = document.createElement("div");
												link.appendChild(div);
												div.classList.add("link");
												div.innerHTML = "<h2 style=\"margin: 8px 0px 8px 0px;\"><b>" + content.title + "</h2></b>";
												if (content.description) {
													div.innerHTML += "<span>" + content.description + "</span><br>"
												}
												if (content.site_name) {
													div.innerHTML += "<span class=\"attr\">" + content.site_name + "</span>"
												}
											}
										}
										else if (type === "audio") {
											div = document.createElement("div");
											card.appendChild(div);
											if (content.embed_html) {
												div.innerHTML = content.embed_html;
											}
											else {
												info = document.createElement("div");
												info.style.padding = "4px";
												div.appendChild(info);
												audio = document.createElement("audio");
												div.appendChild(audio);
												div.classList.add("audio-wrapper");
												audio.classList.add("audio-player");
												audio.setAttribute("controls", "");
													audio.innerText = "Sorry! Your browser does not support the HTML audio player :/"
													source = document.createElement("source");
													audio.appendChild(source);
													if (content.url) {
														source.src = content.url;
													}
													if (content.poster) {
														poster = document.createElement("img");
														info.appendChild(poster);
														poster.classList.add("poster");
														poster.src = content.poster[0].url;
													}
													if (content.title) {
														info.innerHTML += "<h2 style=\"padding-top:8px;\" class=\"track-title\"><b>" + content.title + "</h2></b>";
													}
													else {
														info.innerHTML += "<h2 class=\"track-title\"><b>No Title Provided</h2></b>";
													}
													if (content.artist) {
														info.innerHTML += "<p class=\"track-title\">" + content.artist + "</p>"
													}
													else {
														info.innerHTML += "<p class=\"track-title\">No Artist Provided</p>"
													}
													if (content.album) {
														info.innerHTML += "<p class=\"track-title\">" + content.album + "</p>"
													}
													else {
														info.innerHTML += "<p class=\"track-title\">No Album Provided</p>"
													}
											}
										}
										else if (type === "video") {
											div = document.createElement("div");
											card.appendChild(div);
											if (content.embed_iframe) {
												videoFrame = document.createElement("iframe");
												videoFrame.style.border = "none";
												videoFrame.style.borderRadius = "8px";
												div.appendChild(videoFrame);
												videoFrame.width = 516;
												videoFrame.height = (516 / content.embed_iframe.width) * content.embed_iframe.height;
												videoFrame.src = content.embed_iframe.url;
											}
											else {
												video = document.createElement("video");
												div.appendChild(video);
												div.classList.add("video-wrapper");
												video.classList.add("video-player");
												video.width = 516;
												video.setAttribute("controls", "");
												video.innerText = "Sorry! Your browser does not support the HTML video player :/"
												source = document.createElement("source");
												video.appendChild(source);
												if (content.url) {
													source.src = content.url;
												}
											}
										}
										if (content.attribution) {
											data = content.attribution;
											attr = document.createElement("a");
											card.appendChild(attr);
											attr.classList.add("attr");
											if (data.type === "app") {
												attr.innerText = "Source: " + data.app_name;
											}
											else {
												attr.innerText = "Source: " + data.url.split("/")[2];
											}
											attr.href = data.url;
										}
									}
								}
							</script>
